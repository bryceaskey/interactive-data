source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
help("draw.triple.venn")
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
library(VennDiagram)
library(dplyr)
help(filter)
View(Cyp79A2_DEGs)
View(Cyp79A2_DEGs)
View(Cyp79A2_DEGs)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
Cyp79A2_upregulated <- filter(Cyp79A2_DEGs, log2_fold_change>0)
Cyp79A2_downregulated <- filter(Cyp79A2_DEGs, log2_fold_change<0)
918+1296
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(downregulatedVennDiagram)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
help(merge)
help(intersect)
Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, Ref2_downregulated$locus))
library(VennDiagram)
library(dplyr)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
Cyp79A2_upregulated <- filter(Cyp79A2_DEGs, log2_fold_change>0)
Cyp79A2_downregulated <- filter(Cyp79A2_DEGs, log2_fold_change<0)
Ref5_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/ref5_DEGs.csv")
Ref5_upregulated <- filter(Ref5_DEGs, log2_fold_change>0)
Ref5_downregulated <- filter(Ref5_DEGs, log2_fold_change<0)
Ref2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/ref2_DEGs.csv")
Ref2_upregulated <- filter(Ref2_DEGs, log2_fold_change>0)
Ref2_downregulated <- filter(Ref2_DEGs, log2_fold_change<0)
Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, Ref2_downregulated$locus))
help(Reduce)
View(Cyp79A2_downregulated)
merge(merge(Cyp79A2_downregulated, Ref5_downregulated, by="locus"), Ref2_downregulated, by="locus")
test <- merge(merge(Cyp79A2_downregulated, Ref5_downregulated, by="locus"), Ref2_downregulated, by="locus")
View(test)
test <- merge(merge(Cyp79A2_downregulated, Ref5_downregulated, by="locus", suffixes=c("_Cyp79A2", "_Ref5")), Ref2_downregulated, by="locus", suffixes=c("", "_Ref2"))
View(test)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
Cyp79A2_upregulated <- filter(Cyp79A2_DEGs, log2_fold_change>0)
Cyp79A2_downregulated <- filter(Cyp79A2_DEGs, log2_fold_change<0)
Ref5_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/ref5_DEGs.csv")
Ref5_upregulated <- filter(Ref5_DEGs, log2_fold_change>0)
Ref5_downregulated <- filter(Ref5_DEGs, log2_fold_change<0)
Ref2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/ref2_DEGs.csv")
Ref2_upregulated <- filter(Ref2_DEGs, log2_fold_change>0)
Ref2_downregulated <- filter(Ref2_DEGs, log2_fold_change<0)
View(Cyp79A2_DEGs)
View(Cyp79A2_DEGs)
colnames(Cyp79A2_DEGs)[2:11] <- paste("Cyp79A2", colnames(Cyp79A2_DEGs)[2:11])
View(Cyp79A2_DEGs)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
colnames(Cyp79A2_DEGs)[5:11] <- paste("Cyp79A2_", colnames(Cyp79A2_DEGs)[2:11], sep="")
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
colnames(Cyp79A2_DEGs)[5:11] <- paste("Cyp79A2_", colnames(Cyp79A2_DEGs)[5:11], sep="")
View(Cyp79A2_DEGs)
View(Cyp79A2_DEGs)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
colnames(Cyp79A2_DEGs)[c(6,8)] <- paste(colnames(Cyp79A2_DEGs)[c(6,8)], "Cyp79A2", sep="")
View(Cyp79A2_DEGs)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
colnames(Cyp79A2_DEGs)[c(6,8)] <- paste(colnames(Cyp79A2_DEGs)[c(6,8)], "_A", sep="")
View(Cyp79A2_DEGs)
View(Cyp79A2_DEGs)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
colnames(Cyp79A2_DEGs)[c(6,8)] <- paste(colnames(Cyp79A2_DEGs)[c(6,8)], "_A", sep="")
colnames(Cyp79A2_DEGs)[c(10,11)] <- paste(colnames(Cyp79A2_DEGs)[c(10,11)], "_Cyp79A2", sep="")
Cyp79A2_upregulated <- filter(Cyp79A2_DEGs, log2_fold_change_Cyp79A2>0)
Cyp79A2_downregulated <- filter(Cyp79A2_DEGs, log2_fold_change_Cyp79A2<0)
View(Cyp79A2_DEGs)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
genesInCommon <- Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, Ref2_downregulated$locus))
Cyp79A2_genes <- filter(Cyp79A2_DEGs, locus %in% genesInCommon)
View(Cyp79A2_genes)
genesInCommon <- Reduce(intersect, list(Cyp79A2_DEGs$locus, Ref5_DEGs$locus, Ref2_DEGs$locus))
Cyp79A2_genes <- filter(Cyp79A2_DEGs, locus %in% genesInCommon)
View(Cyp79A2_genes)
genesInCommon <- Reduce(intersect, list(Cyp79A2_DEGs$locus, Ref5_DEGs$locus, Ref2_DEGs$locus))
Cyp79A2_genes <- filter(Cyp79A2_DEGs, locus %in% genesInCommon)
Ref5_genes <- filter(Ref5_DEGs, locus %in% genesInCommon)
Ref2_genes <- filter(Ref2_DEGs, locus %in% genesInCommon)
help(cbind)
View(Cyp79A2_genes)
View(Ref5_genes)
View(Cyp79A2_genes)
View(Ref5_genes)
View(Cyp79A2_genes)
library(VennDiagram)
library(dplyr)
Cyp79A2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Cyp79A2_DEGs.csv")
colnames(Cyp79A2_DEGs)[c(6,8)] <- paste(colnames(Cyp79A2_DEGs)[c(6,8)], "_A", sep="")
colnames(Cyp79A2_DEGs)[c(10,11)] <- paste(colnames(Cyp79A2_DEGs)[c(10,11)], "_Cyp79A2", sep="")
Cyp79A2_upregulated <- filter(Cyp79A2_DEGs, log2_fold_change_Cyp79A2>0)
Cyp79A2_downregulated <- filter(Cyp79A2_DEGs, log2_fold_change_Cyp79A2<0)
Ref5_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/ref5_DEGs.csv")
colnames(Ref5_DEGs)[c(6,8)] <- paste(colnames(Ref5_DEGs)[c(6,8)], "_B", sep="")
colnames(Ref5_DEGs)[c(10,11)] <- paste(colnames(Ref5_DEGs)[c(10,11)], "_Ref5", sep="")
Ref5_upregulated <- filter(Ref5_DEGs, log2_fold_change_Ref5>0)
Ref5_downregulated <- filter(Ref5_DEGs, log2_fold_change_Ref5<0)
Ref2_DEGs <- read.csv(file="C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/ref2_DEGs.csv")
colnames(Ref2_DEGs)[c(6,8)] <- paste(colnames(Ref2_DEGs)[c(6,8)], "_C", sep="")
colnames(Ref2_DEGs)[c(10,11)] <- paste(colnames(Ref2_DEGs)[c(10,11)], "_Ref2", sep="")
Ref2_upregulated <- filter(Ref2_DEGs, log2_fold_change_Ref2>0)
Ref2_downregulated <- filter(Ref2_DEGs, log2_fold_change_Ref2<0)
#draw.triple.venn(
#  area1=nrow(Cyp79A2_upregulated),
#  area2=nrow(Ref5_upregulated),
#  area3=nrow(Ref2_upregulated),
#  n12=length(intersect(Cyp79A2_upregulated$locus, Ref5_upregulated$locus)),
#  n13=length(intersect(Cyp79A2_upregulated$locus, Ref2_upregulated$locus)),
#  n23=length(intersect(Ref5_upregulated$locus, Ref2_upregulated$locus)),
#  n123=length(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, Ref2_upregulated$locus))),
#  category=c("Cyp79A2", "ref5", "ref2"),
#  lty="blank",
#  fill=c("skyblue", "pink1", "mediumorchid"),
#)
draw.triple.venn(
area1=nrow(Cyp79A2_downregulated),
area2=nrow(Ref5_downregulated),
area3=nrow(Ref2_downregulated),
n12=length(intersect(Cyp79A2_downregulated$locus, Ref5_downregulated$locus)),
n13=length(intersect(Cyp79A2_downregulated$locus, Ref2_downregulated$locus)),
n23=length(intersect(Ref5_downregulated$locus, Ref2_downregulated$locus)),
n123=length(Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, Ref2_downregulated$locus))),
category=c("Cyp79A2", "ref5", "ref2"),
lty="blank",
fill=c("skyblue", "pink1", "mediumorchid"),
)
# Note - # of genes will be different from venn diagram bc venn diagram only includes genes which are misregulated in the same direction (i.e. up/down)
genesInCommon <- Reduce(intersect, list(Cyp79A2_DEGs$locus, Ref5_DEGs$locus, Ref2_DEGs$locus))
Cyp79A2_genes <- filter(Cyp79A2_DEGs, locus %in% genesInCommon)
Ref5_genes <- filter(Ref5_DEGs, locus %in% genesInCommon)[, c(1,6:11)]
Ref2_genes <- filter(Ref2_DEGs, locus %in% genesInCommon)[, c(1,6:11)]
View(Cyp79A2_genes)
View(Ref2_genes)
View(Ref5_genes)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(DEGs_intersectAll)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(DEGs_intersectAll)
help(setdiff)
genesA2Ref5 <- setdiff(intersect(Cyp79A2_DEGs$locus, Ref5_DEGs$locus), Reduce(intersect, list(Cyp79A2_DEGs$locus, Ref5_DEGs$locus, Ref2_DEGs$locus)))
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R', echo=TRUE)
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
view(DEGs_A2Ref5$upregulated)
View(DEGs_A2Ref5)
View(DEGs_A2Ref5)
View(DEGs_A2Ref5[["upregulated"]])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
c(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]])
test <- c(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]])
test <- array(c(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]]))
test <- array(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]])
help(array)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
View(DEGs_A2Ref5[["upregulated"]])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2[["downregulated"]])
DEGs_A2Ref5$upregulated$mean_log2_fold_change <- rowMeans(DEGs_A2Ref5$upregulated[c(10,16)])
DEGs_A2Ref5$downregulated$mean_log2_fold_change <- rowMeans(DEGs_A2Ref5$downregulated[c(10,16)])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
help(order)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
heatmapData <- DEGs_A2Ref5$upregulated[,c(1:4,10,16)]
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
View(heatmapData)
View(heatmapData)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmap)
View(heatmapData)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
levels(heatmapData$locus)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
help(pdf)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
dev.off()
dev.off()
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
dev.off()
dev.off()
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2[["upregulated"]])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/PRJNA388948-DEG-analysis.R')
source('~/Cyp79A2-RNAseq/R-scripts/PRJNA388948-DEG-analysis.R')
View(ref2_DEGs)
View(ref5_DEGs)
sum(ref5_DEGs$locus=="AT4G27410")
ref5_DGEs[ref5_DEGs$locus=="AT4G27410", ]
ref5_DEGs[ref5_DEGs$locus=="AT4G27410", ]
install.packages("visNetwork")
library(visNetwork)
# data used in next examples
nb <- 10
nodes <- data.frame(id = 1:nb, label = paste("Label", 1:nb),
group = sample(LETTERS[1:3], nb, replace = TRUE), value = 1:nb,
title = paste0("<p>", 1:nb,"<br>Tooltip !</p>"), stringsAsFactors = FALSE)
edges <- data.frame(from = c(8,2,7,6,1,8,9,4,6,2),
to = c(3,7,2,7,9,1,5,3,2,9),
value = rnorm(nb, 10), label = paste("Edge", 1:nb),
title = paste0("<p>", 1:nb,"<br>Edge Tooltip !</p>"))
View(edges)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visOptions(highlightNearest = TRUE) %>%
visLayout(randomSeed = 123)
# minimal example
nodes <- data.frame(id = 1:3)
edges <- data.frame(from = c(1,2), to = c(1,3))
visNetwork(nodes, edges)
# data used in next examples
nb <- 10
nodes <- data.frame(id = 1:nb, label = paste("Label", 1:nb),
group = sample(LETTERS[1:3], nb, replace = TRUE), value = 1:nb,
title = paste0("<p>", 1:nb,"<br>Tooltip !</p>"), stringsAsFactors = FALSE)
edges <- data.frame(from = c(8,2,7,6,1,8,9,4,6,2),
to = c(3,7,2,7,9,1,5,3,2,9),
value = rnorm(nb, 10), label = paste("Edge", 1:nb),
title = paste0("<p>", 1:nb,"<br>Edge Tooltip !</p>"))
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visOptions(highlightNearest = TRUE) %>%
visLayout(randomSeed = 123)
help(setdiff)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
length(genesA2Ref5NAA)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R', echo=TRUE)
View(DEGs_A2Ref5NAA_4)
genesA2Ref5NAA <- setdiff(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, NAA_treated_upregulated$locus)), Ref2_upregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_upregulated, locus %in% genesA2Ref5NAA)
Ref5_genes <- filter(Ref5_upregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
NAA_genes <- filter(NAA_treated_upregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
A2Ref5NAA_upregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), NAA_genes, by="locus")
genesA2Ref5NAA <- setdiff(Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, NAA_treated_downregulated$locus)), Ref2_downregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_downregulated, locus %in% genesA2Ref5NAA)
Ref5_genes <- filter(Ref5_downregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
NAA_genes <- filter(NAA_treated_downregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
A2Ref5NAA_downregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), NAA_genes, by="locus")
DEGs_A2Ref5NAA_4 <- list(upregulated=A2Ref5NAA_upregulated, downregulated=A2Ref5NAA_downregulated)
View(DEGs_A2Ref5NAA_4)
genesA2Ref5Ref2 <- setdiff(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, Ref2_upregulated$locus)), NAA_treated_upregulated$locus)
length(genesA2Ref5Ref2)
genesA2Ref5Ref2 <- setdiff(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, Ref2_upregulated$locus)), NAA_treated_upregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_upregulated, locus %in% genesA2Ref5Ref2)
Ref5_genes <- filter(Ref5_upregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
Ref2_genes <- filter(Ref2_upregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
A2Ref5Ref2_upregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), Ref2_genes, by="locus")
genesA2Ref5Ref2 <- setdiff(Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, Ref2_downregulated$locus)), NAA_treated_downregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_downregulated, locus %in% genesA2Ref5Ref2)
Ref5_genes <- filter(Ref5_downregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
Ref2_genes <- filter(Ref2_downregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
A2Ref5Ref2_downregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), Ref2_genes, by="locus")
DEGs_A2Ref5Ref2_4 <- list(upregulated=A2Ref5Ref2_upregulated, downregulated=A2Ref5Ref2_downregulated)
View(DEGs_A2Ref5Ref2_4)
genesA2Ref5 <- setdiff(intersect(Cyp79A2_upregulated$locus, Ref5_upregulated$locus), union(Ref2_upregulated$locus, NAA_treated_upregulated$locus))
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
DEGs_A2Ref5 <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/intersections/4-way-intersection/DEGs_A2Ref5_4.rds")
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]$mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]$mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
}
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]$mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
}
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
}
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
DEGs_A2Ref5 <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/intersections/4-way-intersection/DEGs_A2Ref5_4.rds")
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
DEGs_A2Ref5 <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/intersections/4-way-intersection/DEGs_A2Ref5_4.rds")
View(DEGs_A2Ref5)
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
help(order)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
help(all_of)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(DEGs_A2Ref5)
View(DEGs_A2Ref5$upregulated)
View(heatmapData)
128/2
47+17
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
help(scale_fill_gradient)
help(rescale)
rescale(c(0,6))
library(scales)
rescale(c(0,6))
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
rescale(min(heatmapData$log2_FC),0,max(heatmapData$log2_FC))
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
DEG_data_upregulated <- DEGs_A2Ref5[["upregulated"]]
View(DEG_data_upregulated)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2$downregulated)
shiny::runApp('interactive-data/RNAseq')
PRJNA230565_data <- readRDS("data/PRJNA230565.rds")
setwd("C:/Users/Bryce/Documents/interactive-data/RNAseq/")
PRJNA230565_data <- readRDS("data/PRJNA230565.rds")
View(PRJNA230565_data)
source('~/interactive-data/RNAseq/loadData_PRJNA230565.R')
source('~/interactive-data/RNAseq/loadData_PRJNA230565.R')
View(tmmAllGenes)
View(fpkmAllGenes)
sqrt(2)
View(fpkmAllGenes)
source('~/interactive-data/RNAseq/loadData_PRJNA230565.R')
source('~/interactive-data/RNAseq/loadData_PRJNA230565.R', echo=TRUE)
sd(c(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3]))/sqrt(2)
sd(c(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3]))
c(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3])
c(fpkmAllGenes[[fpkmAllGenes$locus==geneLocus, 2:3]])
unname(c(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3]))
c(unname(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3]))
sd(c(unname(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3])))
test <- c(unname(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3]))
test <- c(unlist(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3]))
sd(c(unlist(fpkmAllGenes[fpkmAllGenes$locus==geneLocus, 2:3])))
sd(c(21.43039, 23.89147))
source('~/interactive-data/RNAseq/loadData_PRJNA230565.R')
View(NAA_DEGs)
View(araport11)
source('~/interactive-data/RNAseq/loadData_PRJNA230565.R')
View(NAA_DEGs)
help(formatC)
