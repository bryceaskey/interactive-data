View(Cyp79A2_genes)
View(Ref2_genes)
View(Ref5_genes)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R', echo=TRUE)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(DEGs_intersectAll)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(DEGs_intersectAll)
help(setdiff)
genesA2Ref5 <- setdiff(intersect(Cyp79A2_DEGs$locus, Ref5_DEGs$locus), Reduce(intersect, list(Cyp79A2_DEGs$locus, Ref5_DEGs$locus, Ref2_DEGs$locus)))
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R', echo=TRUE)
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/slurm-scripts/venn-diagram.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
view(DEGs_A2Ref5$upregulated)
View(DEGs_A2Ref5)
View(DEGs_A2Ref5)
View(DEGs_A2Ref5[["upregulated"]])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
c(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]])
test <- c(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]])
test <- array(c(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]]))
test <- array(DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]], DEGs_A2Ref5$upregulated[["log2_fold_change_Cyp79A2"]])
help(array)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
View(DEGs_A2Ref5[["upregulated"]])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2[["downregulated"]])
DEGs_A2Ref5$upregulated$mean_log2_fold_change <- rowMeans(DEGs_A2Ref5$upregulated[c(10,16)])
DEGs_A2Ref5$downregulated$mean_log2_fold_change <- rowMeans(DEGs_A2Ref5$downregulated[c(10,16)])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
help(order)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
heatmapData <- DEGs_A2Ref5$upregulated[,c(1:4,10,16)]
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
View(heatmapData)
View(heatmapData)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmap)
View(heatmapData)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
levels(heatmapData$locus)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
help(pdf)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
dev.off()
dev.off()
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
dev.off()
dev.off()
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2[["upregulated"]])
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/PRJNA388948-DEG-analysis.R')
source('~/Cyp79A2-RNAseq/R-scripts/PRJNA388948-DEG-analysis.R')
View(ref2_DEGs)
View(ref5_DEGs)
sum(ref5_DEGs$locus=="AT4G27410")
ref5_DGEs[ref5_DEGs$locus=="AT4G27410", ]
ref5_DEGs[ref5_DEGs$locus=="AT4G27410", ]
install.packages("visNetwork")
library(visNetwork)
# data used in next examples
nb <- 10
nodes <- data.frame(id = 1:nb, label = paste("Label", 1:nb),
group = sample(LETTERS[1:3], nb, replace = TRUE), value = 1:nb,
title = paste0("<p>", 1:nb,"<br>Tooltip !</p>"), stringsAsFactors = FALSE)
edges <- data.frame(from = c(8,2,7,6,1,8,9,4,6,2),
to = c(3,7,2,7,9,1,5,3,2,9),
value = rnorm(nb, 10), label = paste("Edge", 1:nb),
title = paste0("<p>", 1:nb,"<br>Edge Tooltip !</p>"))
View(edges)
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visOptions(highlightNearest = TRUE) %>%
visLayout(randomSeed = 123)
# minimal example
nodes <- data.frame(id = 1:3)
edges <- data.frame(from = c(1,2), to = c(1,3))
visNetwork(nodes, edges)
# data used in next examples
nb <- 10
nodes <- data.frame(id = 1:nb, label = paste("Label", 1:nb),
group = sample(LETTERS[1:3], nb, replace = TRUE), value = 1:nb,
title = paste0("<p>", 1:nb,"<br>Tooltip !</p>"), stringsAsFactors = FALSE)
edges <- data.frame(from = c(8,2,7,6,1,8,9,4,6,2),
to = c(3,7,2,7,9,1,5,3,2,9),
value = rnorm(nb, 10), label = paste("Edge", 1:nb),
title = paste0("<p>", 1:nb,"<br>Edge Tooltip !</p>"))
visNetwork(nodes, edges, height = "500px", width = "100%") %>%
visOptions(highlightNearest = TRUE) %>%
visLayout(randomSeed = 123)
help(setdiff)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
length(genesA2Ref5NAA)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R', echo=TRUE)
View(DEGs_A2Ref5NAA_4)
genesA2Ref5NAA <- setdiff(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, NAA_treated_upregulated$locus)), Ref2_upregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_upregulated, locus %in% genesA2Ref5NAA)
Ref5_genes <- filter(Ref5_upregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
NAA_genes <- filter(NAA_treated_upregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
A2Ref5NAA_upregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), NAA_genes, by="locus")
genesA2Ref5NAA <- setdiff(Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, NAA_treated_downregulated$locus)), Ref2_downregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_downregulated, locus %in% genesA2Ref5NAA)
Ref5_genes <- filter(Ref5_downregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
NAA_genes <- filter(NAA_treated_downregulated, locus %in% genesA2Ref5NAA)[, c(1,6:11)]
A2Ref5NAA_downregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), NAA_genes, by="locus")
DEGs_A2Ref5NAA_4 <- list(upregulated=A2Ref5NAA_upregulated, downregulated=A2Ref5NAA_downregulated)
View(DEGs_A2Ref5NAA_4)
genesA2Ref5Ref2 <- setdiff(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, Ref2_upregulated$locus)), NAA_treated_upregulated$locus)
length(genesA2Ref5Ref2)
genesA2Ref5Ref2 <- setdiff(Reduce(intersect, list(Cyp79A2_upregulated$locus, Ref5_upregulated$locus, Ref2_upregulated$locus)), NAA_treated_upregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_upregulated, locus %in% genesA2Ref5Ref2)
Ref5_genes <- filter(Ref5_upregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
Ref2_genes <- filter(Ref2_upregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
A2Ref5Ref2_upregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), Ref2_genes, by="locus")
genesA2Ref5Ref2 <- setdiff(Reduce(intersect, list(Cyp79A2_downregulated$locus, Ref5_downregulated$locus, Ref2_downregulated$locus)), NAA_treated_downregulated$locus)
Cyp79A2_genes <- filter(Cyp79A2_downregulated, locus %in% genesA2Ref5Ref2)
Ref5_genes <- filter(Ref5_downregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
Ref2_genes <- filter(Ref2_downregulated, locus %in% genesA2Ref5Ref2)[, c(1,6:11)]
A2Ref5Ref2_downregulated <- merge(merge(Cyp79A2_genes, Ref5_genes, by="locus"), Ref2_genes, by="locus")
DEGs_A2Ref5Ref2_4 <- list(upregulated=A2Ref5Ref2_upregulated, downregulated=A2Ref5Ref2_downregulated)
View(DEGs_A2Ref5Ref2_4)
genesA2Ref5 <- setdiff(intersect(Cyp79A2_upregulated$locus, Ref5_upregulated$locus), union(Ref2_upregulated$locus, NAA_treated_upregulated$locus))
source('~/Cyp79A2-RNAseq/R-scripts/DEG-intersections.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
DEGs_A2Ref5 <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/intersections/4-way-intersection/DEGs_A2Ref5_4.rds")
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]$mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]$mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
}
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]$mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
}
draw_heatmap <- function(DEG_data, num_samples){
if(num_samples==1){
dataCols <- 10
}else if(num_samples==2){
dataCols <- c(10,16)
}else if(num_samples==3){
dataCols <- c(10,16,22)
}
print(DEG_data)
DEG_data <- DEG_data[["upregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$upregulated[dataCols])
DEG_data <- DEG_data[["downregulated"]]mean_log2_fold_change <- rowMeans(DEG_data$downregulated[dataCols])
heatmapData <- DEG_data$upregulated[,c(1:4, dataCols, max(dataCols)+1)]
heatmapData <- rbind(heatmapData, DEG_data$downregulated[,c(1:4, dataCols, max(dataCols)+1)])
#heatmapData <- heatmapData[order(heatmapData$)]
#DEG_data$upregulated <- DEG_data$upregulated[order(DEG_data$upregulated$mean_log2_fold_change),]
return(heatmapData)
}
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
DEGs_A2Ref5 <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/intersections/4-way-intersection/DEGs_A2Ref5_4.rds")
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
DEGs_A2Ref5 <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/intersections/4-way-intersection/DEGs_A2Ref5_4.rds")
View(DEGs_A2Ref5)
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
help(order)
View(heatmapData)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(heatmapData)
help(all_of)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
heatmapData <- draw_heatmap(DEGs_A2Ref5, 2)
View(DEGs_A2Ref5)
View(DEGs_A2Ref5$upregulated)
View(heatmapData)
128/2
47+17
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
help(scale_fill_gradient)
help(rescale)
rescale(c(0,6))
library(scales)
rescale(c(0,6))
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
rescale(min(heatmapData$log2_FC),0,max(heatmapData$log2_FC))
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5)
DEG_data_upregulated <- DEGs_A2Ref5[["upregulated"]]
View(DEG_data_upregulated)
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
source('~/Cyp79A2-RNAseq/R-scripts/DEG-heatmaps.R')
View(DEGs_A2Ref5Ref2)
View(DEGs_A2Ref5Ref2$downregulated)
rdsData <- readRDS("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/PRJNA388948.rds")
View(rdsData)
library(edgeR)
library(tibble)
# Specify paths to data files
justCounts <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/expression_counts/"
geneLengths <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/gene_lengths.txt"
araport11 <- read.csv("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Araport11.csv", header=FALSE)
# Load gene expression and gene length data
countFiles <- paste(justCounts, dir(justCounts), sep="")
countFiles
justCounts <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/expression_counts_med5//"
geneLengths <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/gene_lengths.txt"
araport11 <- read.csv("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Araport11.csv", header=FALSE)
# Load gene expression and gene length data
countFiles <- paste(justCounts, dir(justCounts), sep="")
countFiles
# Differential gene expression analysis using edgeR package
# Goal - perform pairwise comparisons of expression data
# Install and load packages
#if (!requireNamespace("BiocManager", quietly = TRUE))
#  install.packages("BiocManager")
#BiocManager::install("edgeR")
library(edgeR)
library(tibble)
# Specify paths to data files
justCounts <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/expression_counts_med5/"
geneLengths <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/gene_lengths.txt"
araport11 <- read.csv("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Araport11.csv", header=FALSE)
# Load gene expression and gene length data
countFiles <- paste(justCounts, dir(justCounts), sep="")
countLabels <- c("WT_rep1", "WT_rep2", "WT_rep3",
"med5_rep1", "med5_rep2", "med5_rep3",
"ref5med5_rep1", "ref5med5_rep2", "ref5med5_rep3",
"ref2med5_rep1", "ref2med5_rep2", "ref2med5_rep3")
expressionData <- readDGE(countFiles,
labels=countLabels,
group=c("A", "A", "A", "B", "B", "B", "C", "C", "C", "D", "D", "D"))
expressionData$genes <- read.delim(geneLengths, row.names=1)
# Only keep genes with significant level of expression
keep <- filterByExpr(expressionData)
expressionData <- expressionData[keep, , keep.lib.sizes=FALSE]
# Normalize for library size
expressionData <- calcNormFactors(expressionData, method="TMM")
# Create MDS plot to verify integrity of RNAseq data
plotMDS(expressionData, method="bcv")
# Perform DEG analysis to compare gene expression of ref5 and ref2 to WT
expDesign <- model.matrix(~0+group, data=expressionData$samples)
expressionData <- estimateDisp(expressionData, design=expDesign)
colnames(expDesign) <- levels(expressionData$samples$group)
modelFit <- glmQLFit(expressionData, expDesign)
contrast_med5_vs_WT <- makeContrasts(B-A, levels=expDesign)
med5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_med5_vs_WT)
med5_DEGs <- topTags(med5_vs_WT, n=nrow(expressionData), p.value=1)$table
med5_DEGs <- rownames_to_column(med5_DEGs, var="locus")
contrast_ref5med5_vs_WT <- makeContrasts(C-A, levels=expDesign)
ref5med5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_ref5med5_vs_WT)
ref5med5_DEGs <- topTags(ref5med5_vs_WT, n=nrow(expressionData), p.value=1)$table
ref5med5_DEGs <- rownames_to_column(ref5med5_DEGs, var="locus")
contrast_ref2med5_vs_WT <- makeContrasts(D-A, levels=expDesign)
ref2med5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_ref2med5_vs_WT)
ref2med5_DEGs <- topTags(ref2med5_vs_WT, n=nrow(expressionData), p.value=1)$table
ref2med5_DEGs <- rownames_to_column(ref2med5_DEGs, var="locus")
# Load gene annotations
araport11 <- araport11[, c(1, 3, 4, 13)]
colnames(araport11) <- c("locus", "short_name", "name", "aliases")
# Add gene annotations to DEG dataframes
med5_DEGs <- merge(araport11, med5_DEGs, by="locus", all.y=TRUE)
ref5med5_DEGs <- merge(araport11, ref5med5_DEGs, by="locus", all.y=TRUE)
ref2med5_DEGs <- merge(araport11, ref2med5_DEGs, by="locus", all.y=TRUE)
# Calculate fpkm for all genes
fpkmAllGenes <- as.data.frame(rpkm(expressionData$counts, gene.length=expressionData$genes$Length, normalized.lib.sizes=TRUE, log=FALSE))
fpkmAllGenes <- rownames_to_column(fpkmAllGenes, var="locus")
# Calculate tmm for all genes
tmmAllGenes <- as.data.frame(cpm(expressionData, log=FALSE))
tmmAllGenes <- rownames_to_column(tmmAllGenes, var="locus")
View(fpkmAllGenes)
View(tmmAllGenes)
source('~/interactive-data/RNAseq/loadData_PRJNA388948-med5.R')
View(DEGs_PRJNA388948_med5)
F
library(edgeR)
library(tibble)
# Specify paths to data files
justCounts <- "C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/PRJNA388948/expression_counts/"
geneLengths <- "C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/PRJNA388948/gene_lengths.txt"
araport11 <- read.csv("C:/Users/bca08_000/Documents/Cyp79A2-RNAseq/data/Araport11.csv", header=FALSE)
# Load gene expression and gene length data
countFiles <- paste(justCounts, dir(justCounts), sep="")
# Specify paths to data files
justCounts <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/expression_counts/"
geneLengths <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/gene_lengths.txt"
araport11 <- read.csv("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Araport11.csv", header=FALSE)
# Load gene expression and gene length data
countFiles <- paste(justCounts, dir(justCounts), sep="")
countFiles
# Differential gene expression analysis using edgeR package
# Goal - perform pairwise comparisons of expression data
# Install and load packages
#if (!requireNamespace("BiocManager", quietly = TRUE))
#  install.packages("BiocManager")
#BiocManager::install("edgeR")
library(edgeR)
library(tibble)
# Specify paths to data files
justCounts <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/expression_counts/"
geneLengths <- "C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/PRJNA388948/gene_lengths.txt"
araport11 <- read.csv("C:/Users/Bryce/Documents/Cyp79A2-RNAseq/data/Araport11.csv", header=FALSE)
# Load gene expression and gene length data
countFiles <- paste(justCounts, dir(justCounts), sep="")
countLabels <- c("WT_rep1", "WT_rep2", "WT_rep3",
"ref5_rep1", "ref5_rep2", "ref5_rep3",
"ref2_rep1", "ref2_rep2", "ref2_rep3",
"med5_rep1", "med5_rep2", "med5_rep3",
"ref5med5_rep1", "ref5med5_rep2", "ref5med5_rep3",
"ref2med5_rep1", "ref2med5_rep2", "ref2med5_rep3")
expressionData <- readDGE(countFiles,
labels=countLabels,
group=c("A", "A", "A", "B", "B", "B", "C", "C", "C", "D", "D", "D", "E", "E", "E", "G", "G", "G"))
expressionData$genes <- read.delim(geneLengths, row.names=1)
# Only keep genes with significant level of expression
keep <- filterByExpr(expressionData)
expressionData <- expressionData[keep, , keep.lib.sizes=FALSE]
# Normalize for library size
expressionData <- calcNormFactors(expressionData, method="TMM")
# Create MDS plot to verify integrity of RNAseq data
plotMDS(expressionData, method="bcv")
# Perform DEG analysis to compare gene expression of ref5 and ref2 to WT
expDesign <- model.matrix(~0+group, data=expressionData$samples)
expressionData <- estimateDisp(expressionData, design=expDesign)
colnames(expDesign) <- levels(expressionData$samples$group)
modelFit <- glmQLFit(expressionData, expDesign)
contrast_ref5_vs_WT <- makeContrasts(B-A, levels=expDesign)
ref5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_ref5_vs_WT)
ref5_DEGs <- topTags(ref5_vs_WT, n=nrow(expressionData), p.value=1)$table
ref5_DEGs <- rownames_to_column(ref5_DEGs, var="locus")
contrast_ref2_vs_WT <- makeContrasts(C-A, levels=expDesign)
ref2_vs_WT <- glmQLFTest(modelFit, contrast=contrast_ref2_vs_WT)
ref2_DEGs <- topTags(ref2_vs_WT, n=nrow(expressionData), p.value=1)$table
ref2_DEGs <- rownames_to_column(ref2_DEGs, var="locus")
contrast_med5_vs_WT <- makeContrasts(D-A, levels=expDesign)
med5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_med5_vs_WT)
med5_DEGs <- topTags(med5_vs_WT, n=nrow(expressionData), p.value=1)$table
med5_DEGs <- rownames_to_column(med5_DEGs, var="locus")
contrast_ref5med5_vs_WT <- makeContrasts(E-A, levels=expDesign)
ref5med5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_ref5med5_vs_WT)
ref5med5_DEGs <- topTags(ref5med5_vs_WT, n=nrow(expressionData), p.value=1)$table
ref5med5_DEGs <- rownames_to_column(ref5med5_DEGs, var="locus")
contrast_ref2med5_vs_WT <- makeContrasts(G-A, levels=expDesign)
ref2med5_vs_WT <- glmQLFTest(modelFit, contrast=contrast_ref2med5_vs_WT)
ref2med5_DEGs <- topTags(ref2med5_vs_WT, n=nrow(expressionData), p.value=1)$table
ref2med5_DEGs <- rownames_to_column(ref2med5_DEGs, var="locus")
# Load gene annotations
araport11 <- araport11[, c(1, 3, 4, 13)]
colnames(araport11) <- c("locus", "short_name", "name", "aliases")
# Add gene annotations to DEG dataframes
ref5_DEGs <- merge(araport11, ref5_DEGs, by="locus", all.y=TRUE)
ref2_DEGs <- merge(araport11, ref2_DEGs, by="locus", all.y=TRUE)
med5_DEGs <- merge(araport11, med5_DEGs, by="locus", all.y=TRUE)
ref5med5_DEGs <- merge(araport11, ref5med5_DEGs, by="locus", all.y=TRUE)
ref2med5_DEGs <- merge(araport11, ref2med5_DEGs, by="locus", all.y=TRUE)
# Calculate fpkm for all genes
fpkmAllGenes <- as.data.frame(rpkm(expressionData$counts, gene.length=expressionData$genes$Length, normalized.lib.sizes=TRUE, log=FALSE))
fpkmAllGenes <- rownames_to_column(fpkmAllGenes, var="locus")
# Calculate tmm for all genes
tmmAllGenes <- as.data.frame(cpm(expressionData, log=FALSE))
tmmAllGenes <- rownames_to_column(tmmAllGenes, var="locus")
View(tmmAllGenes)
source('~/interactive-data/RNAseq/loadData_PRJNA388948.R')
View(DEGs_PRJNA388948_med5)
setwd("C:/Users/Bryce/Documents/interactive-data/RNAseq/")
PRJNA388948_data <- readRDS("data/PRJNA388948_med5.rds")
View(PRJNA388948_data)
View(PRJNA388948_data)
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
